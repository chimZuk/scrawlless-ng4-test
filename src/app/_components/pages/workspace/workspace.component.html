<svg version="1.1" id="cover" #container baseProfile="full" xmlns="http://www.w3.org/2000/svg" class="" [attr.width]="0.9 * vw" [attr.height]="0.9 * 1.25 * vw" viewBox="0 0 800 1000">   

        <defs>
            <pattern id="smallGrid" width="20" height="20" patternUnits="userSpaceOnUse">
              <path d="M 20 0 L 0 0 0 20" fill="none" stroke="#69b0b7" stroke-width="0.5"/>
            </pattern>
            </defs>
            <defs>
                <filter id="f1" x="-50%" y="-50%" width="200%" height="200%">
                    <feOffset result="offOut" in="SourceAlpha" dx="-0.175" dy="-0.175" />
                    <feGaussianBlur result="blurOut" in="offOut" stdDeviation="0.35" />
                  <feBlend in="SourceGraphic" in2="blurOut" mode="normal" />
                </filter>
              </defs>
            <rect width="100%" height="100%" fill="#fff" />
            <svg:rect #list (click)="setCursor($event, 'canvas', 0);" id="list" width="100%" height="100%" [attr.fill]="'url(' + absUrl + '#smallGrid)'" />
            
            <line x1="0" y1="0" x2="800" y2="0" stroke="#69b0b7" stroke-width="1" />
            <line x1="0" y1="0" x2="0" y2="1000" stroke="#69b0b7" stroke-width="1" />
            <line x1="800" y1="1000" x2="0" y2="1000" stroke="#69b0b7" stroke-width="1" />
            <line x1="800" y1="1000" x2="800" y2="0" stroke="#69b0b7" stroke-width="1" />
            
            <line x1="700.55" y1="0" x2="700.55" y2="1000" stroke="#ed7e28" stroke-width="1.1" />

            <circle [attr.filter]="'url(' + absUrl + '#f1)'" cx="500" cy="150" r="50" stroke="green" stroke-width="1" fill="yellow" class="" (click)="select($event)" />
            <circle [attr.filter]="'url(' + absUrl + '#f1)'" cx="400" cy="500" r="80" stroke="green" stroke-width="1" fill="yellow" class="" (click)="select($event)" />

            <!--<g [attr.filter]="'url(' + absUrl + '#f1)'">                
            <text x = "217" y = "257" font-family = "scwlsWorkspace" font-size = "16">&#xe902;&#xe90b;&#xe903;</text>
            <line x1="217" y1="240" x2="261" y2="240" stroke = "#000" stroke-linecap = "round" stroke-miterlimit = "10" stroke-width = "2"/>
            <text x = "260" y = "20" font-family = "scwlsWorkspace" font-size = "16">&#xe904;&#xe90c;&#xe905;&#xe90e;</text>
            <text x = "280" y = "20" font-family = "scwlsWorkspace" font-size = "16">&#xe906;&#xe90f;&#xe907;&#xe90d;&#xe908;&#xe910;&#xe909;&#xe90e;</text>
            </g>-->

            <!--<g *ngFor="let exp of content.expressions; let i = index" [attr.filter]="'url(' + absUrl + '#f1)'">
                    <text class="number" *ngFor="let item of exp.numbers; let i = index" [attr.x] = "item.x + exp.x" [attr.y] = "exp.y" font-family = "scwlsWorkspace" font-size = "16" [innerHTML]="item.text"></text>
                    <text class="operator" *ngFor="let item of exp.operators; let i = index" [attr.x] = "item.x + exp.x" [attr.y] = "exp.y" font-family = "scwlsWorkspace" font-size = "16" [innerHTML]="item.text"></text>
                    <text class="eq" *ngFor="let item of exp.eq; let i = index" [attr.x] = "item.x + exp.x" [attr.y] = "exp.y" font-family = "scwlsWorkspace" font-size = "16" [innerHTML]="item.text"></text>
                </g>-->

    <g *ngFor="let line of lines; let i = index" [attr.filter]="'url(' + absUrl + '#f1)'">
        <g class="element" *ngFor="let exp of line.expressions; let j = index">
            <rect
            (click)="setCursor($event, 'ex', exp);"
            [attr.x] = "line.x + ex[exp].x + ex[ex[exp].pe].x * c - 2" 
            [attr.y] = "
            (line.y + fr[ex[exp].pf].y * hc + ex[exp].t * hc)
            * 
            ex[exp].zn 
            + 
            (line.y + fr[ex[exp].pf].y * hc - (ex[exp].b + 2) * hc)
            * 
            ex[exp].ch
            -
            ex[exp].t * hc - 2 * hc + 3
            "  
            [attr.width]="ex[exp].s * c + 20" 
            [attr.height]="ex[exp].h * hc" 
            class="expression" stroke="transparent" fill="transparent" stroke-width="2"/>


            <text 
            [attr.x] = "setExpression(exp, 'x')" 
            [attr.y] = "setExpression(exp, 'y')"
            class="number" font-family = "scwlsWorkspace" font-size = "16" [innerHTML]="ex[exp].text"></text>

            <!--<text 
            [attr.x] = "line.x + ex[exp].x + ex[ex[exp].pe].x * c" 
            [attr.y] = 
            "
            (line.y + fr[ex[exp].pf].y * hc + ex[exp].t * hc)
            * 
            ex[exp].zn 
            + 
            (line.y + fr[ex[exp].pf].y * hc - (ex[exp].b + 2) * hc)
            * 
            ex[exp].ch
            " 
            class="number" font-family = "scwlsWorkspace" font-size = "16" [innerHTML]="ex[exp].text"></text>-->
        </g>
        <line 
        *ngFor="let fra of line.fractions; let j = index" 
        [attr.x1]="line.x + ex[fr[fra].pe].x * c - 1" 
        [attr.y1]="line.y + fr[fra].y * hc - 17" 
        [attr.x2]="line.x + ex[fr[fra].pe].x * c + (fr[fra].s) * c + 1" 
        [attr.y2]="line.y + fr[fra].y * hc - 17" 
        class="fr" stroke = "#000" stroke-linecap = "round" stroke-miterlimit = "10" stroke-width = "2"/>
   </g>


<text #cursor id="cursor" [attr.filter]="'url(' + absUrl + '#f1)'" [attr.x] = "x" [attr.y] = "y" font-family = "scwlsWorkspace" font-size = "16">&#xe911;</text>
            
  </svg>

<mat-card id="fullscreen" class="ui squareSingle draggable touch" *ngIf="this.brows().name !='Safari'">
    <button mat-fab color="accent" class="fullscreen" *ngIf="!isFullscreen" (click)="isFullscreen = true;" onclick="editor_fullscreen()"><mat-icon>fullscreen</mat-icon></button>
    <button mat-fab color="accent" class="exitFullscreen" *ngIf="isFullscreen" (click)="isFullscreen = false;" onclick="editor_exitFullscreen()"><mat-icon>fullscreen_exit</mat-icon></button>
</mat-card>

<mat-card class="ui squareSingle zIn draggable touch">
    <button mat-fab color="accent" (click)="zoom('1.15')"><mat-icon>zoom_in</mat-icon></button>
</mat-card>
<mat-card class="ui squareSingle zOut draggable touch">
    <button mat-fab color="accent" (click)="zoom(0.85)"><mat-icon>zoom_out</mat-icon></button>
</mat-card>

<mat-card #numbers id="numbers" class="ui keyboard" *ngIf="mode === 'math'">
    <div class="flex-column">
        <div class="flex-row">
            <button mat-raised-button (click)="write(0, 7, 'fr');"><span class="i-font i-seven"></span></button>
            <button mat-raised-button (click)="write(1, 8, 'fr');"><span class="i-font i-eight"></span></button>
            <button mat-raised-button (click)="write(1, 9, 'fr');"><span class="i-font i-nine"></span></button>
        </div>
        <div class="flex-row">
            <button mat-raised-button (click)="write(0, 4, 'fr');"><span class="i-font i-four"></span></button>
            <button mat-raised-button (click)="write(0, 5, 'fr');"><span class="i-font i-five"></span></button>
            <button mat-raised-button (click)="write(0, 6, 'fr');"><span class="i-font i-six"></span></button>
        </div>
        <div class="flex-row">
            <button mat-raised-button (click)="write(0, 1, 'fr');"><span class="i-font i-one"></span></button>
            <button mat-raised-button (click)="write(0, 2, 'fr');"><span class="i-font i-two"></span></button>
            <button mat-raised-button (click)="write(0, 3, 'fr');"><span class="i-font i-three"></span></button>
        </div>
        <div class="flex-row">
            <button mat-raised-button (click)="write(0, 1, 'fr');"><span class="i-font i-dot"></span></button>
            <button mat-raised-button (click)="write(0, 1, 'fr');"><span class="i-font i-zero"></span></button>
            <button mat-raised-button (click)="write(0, 1, 'fr');"><span class="i-font i-comma"></span></button>
        </div>
    </div>
</mat-card>

<mat-card #operators id="operators" class="ui keyboard" *ngIf="mode === 'math'">
    <div class="flex-column">
        <div class="flex-row">
            <button mat-raised-button><span class="i-font i-mult"></span></button>
            <button mat-raised-button><span class="i-font i-divide"></span></button>
        </div>
        <div class="flex-row">
            <button mat-raised-button><span class="i-font i-plus"></span></button>
            <button mat-raised-button><span class="i-font i-minus"></span></button>
        </div>
    </div>
    <button mat-raised-button><span class="i-font i-equal"></span></button>
</mat-card>

<mat-card class="ui tools">
    <button mat-raised-button color="accent" [class.selectedTool]="mode == 'remove'" (click)="switchMode('remove')"><mat-icon>remove_circle_outline</mat-icon></button>
    <button mat-raised-button color="accent" [class.selectedTool]="mode == 'math'" (click)="switchMode('math')"><mat-icon>title</mat-icon></button>
    <button mat-raised-button color="accent" [class.selectedTool]="mode == 'geo'" (click)="switchMode('geo')"><mat-icon>mode_edit</mat-icon></button>
</mat-card>